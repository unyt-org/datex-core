[package]
name = "datex-core"
version = "0.0.4"
description = "The DATEX Core Rust implementation"
authors = [
    "Benedikt Strehle <benedikt@unyt.org>",
    "Jonas Strehle <jonas@unyt.org>",
]
edition = "2021"
license-file = "LICENSE"

[lib]
crate-type = ["cdylib", "rlib"]

[dependencies]
# core dependencies
regex = "1"
byteorder = "1"
num_enum = "0.5.7"
lazy_static = "1.4.0"
strum = { version = "0.24", features = ["derive"] }
mopa = "0.2.2"
num-bigint = "0.4"
num-integer = "0.1"
default-args = "1.0.0"
itertools = "0.10.5"
pest = "2.6"
pest_derive = "2.6"
pad = "0.1"
binrw = "0.14.1"
modular-bitfield = "0.11.2"
thiserror = "2.0.11"
url = "2.5.4"
num-traits = "0.2.19"
async-trait = "0.1.87"
tokio = { version = "1.43.0", features = ["full"] }       # "sync", "rt", "macros"
tokio-tungstenite = { version = "0.21", optional = true }
tungstenite = { version = "0.21", optional = true }
futures-util = { version = "0.3", optional = true }

hex = "0.4.3"
log = { version = "0.4", features = ["std", "serde"] }
cfg-if = "0.1"

# optional dependencies
nostd = { version = "0.1.4", optional = true }
websocket = { version = "0.24.0", optional = true }
rand = { version = "0.8.5", optional = true }
uuid = { version = "1.15.1", features = ["v4"], optional = true }
rsa = { version = "0.9.8", optional = true }
flexi_logger = { version = "0.29.8", optional = true }
console_log = { version = "1.0.0", optional = true }
ansi_term = "0.12.1"
js-sys = { version = "0.3.77", optional = true }

[profile.release]
opt-level = "z"
strip = true
lto = true
codegen-units = 1
panic = "abort"

[profile.dev]
opt-level = 3

# see https://docs.rs/rsa/latest/rsa/
[profile.dev.package.num-bigint-dig]
opt-level = 3

[features]
default = [
    "nostd",

    "native_websocket",
    "native_tcp",
    "native_rand",
    "native_uuid",
    "native_crypto",
    "native_time",
    "flexi_logger",

    "debug",
] # default to nostd

native_websocket = [
    "websocket",         # FIXME remove in future
    "tokio-tungstenite",
    "tungstenite",
    "futures-util",
] # use native websocket
native_tcp = [] # use native tcp
native_time = [] # use native time
native_rand = ["rand"] # use native websocket
native_uuid = ["uuid"] # use native websocket
native_crypto = ["rsa"] # use native crypto

wasm_logger = ["console_log"]

std = []   # use std
debug = []
